type T1 = proto {c: int};
type T2 = proto {b: T1};
x: T2 = convert(T2, convert(bytes, ""));
y: T2 = x;
assert(DEBUG("ref", x) == 2);
assert(DEBUG("ref", x.b) == 1073741823);
assert(DEBUG("ref", x.b.c) == 1);
x.b.c = 1;
type xxgood = {c: array of bytes @ 1};
type xxbad = {b: xxgood @ 2};
xbad: array of xxbad = new(array of xxbad, 3, convert(xxbad, convert(bytes, "")));
xgood: array of xxgood = new(array of xxgood, 3, convert(xxgood, convert(bytes, "")));
r1: array of bytes = new(array of bytes, 3, convert(bytes, "a"));
xbad[0].b.c = r1;
xgood[0].c = r1;
assert(convert(string, xbad[0].b.c[0]) == "a");
assert(convert(string, xgood[0].c[0]) == "a");
r2: array of bytes = new(array of bytes, 3, convert(bytes, "b"));
xbad[1].b.c = r2;
xgood[1].c = r2;
assert(convert(string, xbad[0].b.c[0]) == "a");
assert(convert(string, xgood[0].c[0]) == "a");
assert(convert(string, xbad[1].b.c[0]) == "b");
assert(convert(string, xgood[1].c[0]) == "b");
